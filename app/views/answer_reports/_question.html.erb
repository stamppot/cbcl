<% no = question.number %>
<% id = question.id.to_s %>

<div id='question_number<%= no %>'>

	<!-- this should be put in _question_edit -->
	<% if current_user.access? :survey_edit_delete %>
		<% if no > 0 %>
		Spørgsmål: <%= in_place_editor_field :question, :number, {}, :rows => 1, :size => 2 %>
		<% end %>
		<% end %>

		<table class="question" id="question<%= id %>"> 
			<tbody>
				<%- 

				rows = question.rows_of_cols(cells)
				output = []

				index = 0
				rows.sort.each do |row, cols|
					if !cols.values.any? {|cell| !cell.value.blank?}
						next
					end
					
					color = index % 2 == 0 && "even" || "odd"
					output << "<tr id='row#{id}_#{row}'><td><div> \n" 
					output << 
					if row == 1
						"\t<div class='group'>#{no > 0 && (no.to_roman + ". ") || '&nbsp;'}</div>\n"
					else
						"\t<div>&nbsp;</div>\n"
					end

					no_cols = cols.size

					cols.values.each do |cell|
						@cell = cell
						celltype = cell.class.to_s.downcase
						output << render(:partial => "answer_reports/#{celltype}", :object => cell)
					end
					output << "</div></td></tr>"
				end
				%>
				<%= output.join %>
			</tbody>
		</table>

	</div>

